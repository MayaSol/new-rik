//- Все примеси в этом файле должны начинаться c имени блока (main-nav)
//- Структура меню — в main-nav.data.pug


mixin main-nav(selectedID)
  //- подключаем файл со структурой данных блока
  include main-nav.data.pug

  -
    var menu = mainMenu;
    // console.log(attributes);
    // console.log(menu);

  nav.nav#nav&attributes(attributes)
    +burger('Показать главное меню', 'nav', 'nav--open')(class='nav__toggler')
    +menuList(selectedID,menu)




mixin add-nav(selectedID)
  //- подключаем файл со структурой данных блока
  include main-nav.data.pug

  -
    var menu = addMenu;
    // console.log(attributes);
    // console.log(menu);

  nav.nav#nav-add&attributes(attributes)
    +burger('Показать доп меню', 'nav-add', 'nav--open')(class='nav__toggler')
    +menuList(selectedID,menu)



mixin makeMainNav(selectedID)
  //- подключаем файл со структурой данных блока
  include main-nav.data.pug

  -
    var menu = mainMenu;
    // console.log(attributes);
    // console.log(menu);



mixin menuList(selectedID,menu,attr)

    ul.nav__list&attributes(attributes)
      each menuItem in menu
        +main-nav-item(selectedID, menuItem, 1)
          if (typeof(menuItem.childs) !== 'undefined' && menuItem.childs)
            +main-nav-sublist-wrapper(2)
              each menuItem2 in menuItem.childs
                +main-nav-item(selectedID, menuItem2, 2)
                  if (typeof(menuItem2.childs) !== 'undefined' && menuItem2.childs)
                    +main-nav-sublist-wrapper(3)
                      each menuItem3 in menuItem2.childs
                        +main-nav-item(selectedID, menuItem3, 3)



mixin main-nav-item(selectedID, item, level)
  -
    var thisItemClass = 'nav__item';
    var thisLinkClass = 'nav__link';
    if(selectedID == item.id) {
      thisItemClass += '  nav__item--active';
    }
    if(item.childs) {
      thisItemClass += '  nav__item--has-child';
    }
    if(level > 1) {
      thisItemClass += '  nav__item--lvl-' + level;
      thisLinkClass += '  nav__link--lvl-' + level;
    }

  li(class= thisItemClass)
    a(class= thisLinkClass, href=item.url)= item.name
    block

mixin main-nav-sublist-wrapper(level)
  -
    var divClass = 'nav__sublist-wrapper  nav__sublist-wrapper--lvl-' + level;
    var listClass = 'nav__list  nav__list--lvl-' + level;
  div(class= divClass)
    ul(class= listClass)
      block
